MALLOC(3)LinuxProgrammer'sManualMALLOC(3)$$NAME$malloc,free,calloc,realloc-allocateandfreedynamicmemory$$SYNOPSIS$#include<stdlib.h>$$void*malloc(size_tsize);$voidfree(void*ptr);$void*calloc(size_tnmemb,size_tsize);$void*realloc(void*ptr,size_tsize);$$DESCRIPTION$Themalloc()functionallocatessizebytesandreturnsapointertotheallocatedmemory.Thememoryisnotinitialized.Ifsizeis0,thenmalloc()returns$eitherNULL,orauniquepointervaluethatcanlaterbesuccessfullypassedtofree().$$Thefree()functionfreesthememoryspacepointedtobyptr,whichmusthavebeenreturnedbyapreviouscalltomalloc(),calloc(),orrealloc().Otherwise,or$iffree(ptr)hasalreadybeencalledbefore,undefinedbehavioroccurs.IfptrisNULL,nooperationisperformed.$$Thecalloc()functionallocatesmemoryforanarrayofnmembelementsofsizebyteseachandreturnsapointertotheallocatedmemory.Thememoryissetto$zero.Ifnmemborsizeis0,thencalloc()returnseitherNULL,orauniquepointervaluethatcanlaterbesuccessfullypassedtofree().$$Therealloc()functionchangesthesizeofthememoryblockpointedtobyptrtosizebytes.Thecontentswillbeunchangedintherangefromthestartofthe$regionuptotheminimumoftheoldandnewsizes.Ifthenewsizeislargerthantheoldsize,theaddedmemorywillnotbeinitialized.IfptrisNULL,then$thecallisequivalenttomalloc(size),forallvaluesofsize;ifsizeisequaltozero,andptrisnotNULL,thenthecallisequivalenttofree(ptr).Unless$ptrisNULL,itmusthavebeenreturnedbyanearliercalltomalloc(),calloc()orrealloc().Iftheareapointedtowasmoved,afree(ptr)isdone.$$RETURNVALUE$Themalloc()andcalloc()functionsreturnapointertotheallocatedmemory,whichissuitablyalignedforanybuilt-intype.Onerror,thesefunctionsreturn$NULL.NULLmayalsobereturnedbyasuccessfulcalltomalloc()withasizeofzero,orbyasuccessfulcalltocalloc()withnmemborsizeequaltozero.$$Thefree()functionreturnsnovalue.$$Therealloc()functionreturnsapointertothenewlyallocatedmemory,whichissuitablyalignedforanybuilt-intypeandmaybedifferentfromptr,orNULLif$therequestfails.Ifsizewasequalto0,eitherNULLorapointersuitabletobepassedtofree()isreturned.Ifrealloc()fails,theoriginalblockisleft$untouched;itisnotfreedormoved.$$ERRORS$calloc(),malloc(),andrealloc()canfailwiththefollowingerror:$$ENOMEMOutofmemory.Possibly,theapplicationhittheRLIMIT_ASorRLIMIT_DATAlimitdescribedingetrlimit(2).$$ATTRIBUTES$Foranexplanationofthetermsusedinthissection,seeattributes(7).$$M-bM-^TM-^LM-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-,M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-,M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^P$M-bM-^TM-^BInterfaceM-bM-^TM-^BAttributeM-bM-^TM-^BValueM-bM-^TM-^B$M-bM-^TM-^\M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-<M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-<M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-$$M-bM-^TM-^Bmalloc(),free(),M-bM-^TM-^BThreadsafetyM-bM-^TM-^BMT-SafeM-bM-^TM-^B$M-bM-^TM-^Bcalloc(),realloc()M-bM-^TM-^BM-bM-^TM-^BM-bM-^TM-^B$M-bM-^TM-^TM-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-4M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-4M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^@M-bM-^TM-^X$CONFORMINGTO$POSIX.1-2001,POSIX.1-2008,C89,C99.$$NOTES$Bydefault,Linuxfollowsanoptimisticmemoryallocationstrategy.Thismeansthatwhenmalloc()returnsnon-NULLthereisnoguaranteethatthememoryreally$isavailable.Incaseitturnsoutthatthesystemisoutofmemory,oneormoreprocesseswillbekilledbytheOOMkiller.Formoreinformation,seethe$descriptionof/proc/sys/vm/overcommit_memoryand/proc/sys/vm/oom_adjinproc(5),andtheLinuxkernelsourcefileDocumentation/vm/overcommit-accounting.$$Normally,malloc()allocatesmemoryfromtheheap,andadjuststhesizeoftheheapasrequired,usingsbrk(2).Whenallocatingblocksofmemorylargerthan$MMAP_THRESHOLDbytes,theglibcmalloc()implementationallocatesthememoryasaprivateanonymousmappingusingmmap(2).MMAP_THRESHOLDis128kBbydefault,$butisadjustableusingmallopt(3).Allocationsperformedusingmmap(2)areunaffectedbytheRLIMIT_DATAresourcelimit(seegetrlimit(2)).$$Toavoidcorruptioninmultithreadedapplications,mutexesareusedinternallytoprotectthememory-managementdatastructuresemployedbythesefunctions.Ina$multithreadedapplicationinwhichthreadssimultaneouslyallocateandfreememory,therecouldbecontentionforthesemutexes.ToscalablyhandlememoryalloM-bM-^@M-^P$cationinmultithreadedapplications,glibccreatesadditionalmemoryallocationarenasifmutexcontentionisdetected.Eacharenaisalargeregionofmemory$thatisinternallyallocatedbythesystem(usingbrk(2)ormmap(2)),andmanagedwithitsownmutexes.$$SUSv2requiresmalloc(),calloc(),andrealloc()toseterrnotoENOMEMuponfailure.Glibcassumesthatthisisdone(andtheglibcversionsoftheseroutines$dothis);ifyouuseaprivatemallocimplementationthatdoesnotseterrno,thencertainlibraryroutinesmayfailwithouthavingareasoninerrno.$$Crashesinmalloc(),calloc(),realloc(),orfree()arealmostalwaysrelatedtoheapcorruption,suchasoverflowinganallocatedchunkorfreeingthesame$pointertwice.$$Themalloc()implementationistunableviaenvironmentvariables;seemallopt(3)fordetails.$$SEEALSO$brk(2),mmap(2),alloca(3),malloc_get_state(3),malloc_info(3),malloc_trim(3),malloc_usable_size(3),mallopt(3),mcheck(3),mtrace(3),posix_memalign(3)$$COLOPHON$Thispageispartofrelease4.04oftheLinuxman-pagesproject.Adescriptionoftheproject,informationaboutreportingbugs,andthelatestversionofthis$page,canbefoundathttp://www.kernel.org/doc/man-pages/.$$GNU2015-08-08MALLOC(3)$